### WebSocket

> 서버와 클라이언트 간의 메시지 교환을 위한 통신 규약(프로토콜)

- 특징

  - 양방향 통신
  - 실시간 네트워킹
  - 지속적인 연결
    - HTTP와 달리 클라이언트와 서버 간에 지속적인 연결을 유지
  - 저렴한 지연시간
    - 전송 시간이 매우 짧아 지연 시간이 적음
    - 게임, 채팅, 주식 거래 등 실시간 애플리케이션에 적합
  - 이벤트 기반
    - 이벤트 기반 프로그래밍 모델을 사용
    - 데이터가 도착하는 즉시 처리됨
  - 보안
    - SSL과 같은 보안 프로토콜을 사용하여 데이터 보호

- 장점

  - 전용 서버가 필요하지 않음
    - HTTP 서버에서 WebSocket을 구현할 수 있음
  - 상태가 없으므로 상태 정보를 저장할 필요 없음
  - 데이터가 암호화되므로 보안에 우수

- 동작 과정

  ![img](https://blog.kakaocdn.net/dn/dDiLTo/btrG4Iebgdo/8KL22qu1Iu4rQ1YJlziWY1/img.png)

  - Opening Handshake
    - 클라이언트가 서버에 연결 요청을 보냄
    - 서버는 WebSocket handshake 요청인지 확인
    - 맞다면 응답에 WebSocket 프로토콜 버전, 랜덤한 키 등 포함해서 전송
    - 클라이언트는 이를 수신하고 다시 응답 생성(클라이언트의 랜덤 키 등 포함)
    - 서버는 이를 수신하고, 키를 검증
    - 이후에는 webSocket 프로토콜을 사용하여 데이터 전송 가능
  - Data Transfer
    - 데이터는 frame을 여러 개 구성하는 메시지를 주고받음
    - webSocket을 한번 연결하면, 실시간 양방향 통신 가능
  - Closing Handshake
    - 연결 종료 과정
    - 클라이언트나 서버가 Closing handshake 요청을 보냄
    - 상대방은 수신 후 응답을 보냄
    - 연결이 종료되고 더 이상 데이터 전송 불가



### Socket.io

> 양방향 통신을 하기 위해 웹 소켓을 기반으로 하는 라이브러리

- WebSocket 기반으로 연결을 시도하고 실패하면 다른 방법으로 시도

- HTTP 폴링
  - 일정한 주기로 서버에 요청을 보냄
  - 불필요한 요청과 connection을 생성 서버에 부담을 줌
  - 요청 주기가 짧을수록 부하가 커짐
  - 선택하는 경우
    - 응답을 실시간으로 받지 않아도 되는 경우
    - 다수의 사용자가 동시에 사용하는 경우
    - ex) 메신저 채팅
- HTTP 롱 폴링
  - 일정 주기마다 요청을 보내지만 서버가 응답을 바로 전달하지는 않음
  - 특정 이벤트나 타임아웃이 발생했을 때 응답을 전달
  - 동시 다발적인 요청과 응답이 생기면 부하가 발생
  - 선택하는 경우
    - 응답을 실시간으로 받아야 하는 경우
    - 적은 수의 사용자가 동시에 사용한는 경우
- 장점
  - 브라우저나 서버의 기능에 따라 유연하게 구현 가능
  - 방식에 따른 성능 최적화
  - 쉬운 사용성
    - 쉽게 사용할 수 있는 API 제공



### WebSocket 과 Socket.io 차이점

- Socket.io는 WebSocket을 기반으로 구현된 라이브러리

  |            | WebSocket                                            | Socket.io                        |
  | ---------- | ---------------------------------------------------- | -------------------------------- |
  | 호환성     | 최신 웹 브라우저 지원                                | 이전 버전의 웹 브라우저도 지원   |
  | 프로토콜   | 표준화된 프로토콜                                    | 자체 프로토콜                    |
  | 신뢰성     | 일부 상황에서 연결 유지X<br />ex) 인터넷 연결 불안정 | 연결이 끊어지면 자동 연결        |
  | 라이브러리 | .                                                    | WebSocket보다 추가적인 기능 제공 |
  | 언어 지원  | 대부분 주요 언어                                     | JavaScript 라이브러리            |

  - WebSocket은 단순하고 표준화된 통신 프로토콜에 적합
  - Socket.io는 실시간 웹 애플리케이션에서 적합

